(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d230350"],{eafd:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("XML 文档穿件")])]),a("p",[s._v("创建 xml 文档："),a("code",{pre:!0},[s._v("document.implementation.createDocument(namespaceUri, root, doctype)")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xmldom = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".implementation.createDocument("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('""')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"root"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(");\nalert(xmldom.documentElement.tagName); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//root")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" child = xmldom.createElement("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"child"')]),s._v(");\nxmldom.documentElement.appendChild(child);\n")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("DOMParser 类型")])]),a("ol",[a("li",[s._v("将 xml 解析为 dom 文档")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" parser = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" DOMParser();\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xmldom = parser.parseFromString("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"<root><child/></root>"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"text/xml"')]),s._v(");\nalert(xmldom.documentElement.tagName); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('//"root"')]),s._v("\nalert(xmldom.documentElement.firstChild.tagName);\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" anotherChild = xmldom.createElement("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"child"')]),s._v(");\nxmldom.documentElement.appendChild(anotherChild);\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" children = xmldom.getElementsByTagName("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"child"')]),s._v(");\nalert(children.length); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//2")]),s._v("\n")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("IE9 兼容处理 "),a("code",{pre:!0},[s._v("parseFromString()")]),s._v(" 方法报错")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" parser = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" DOMParser(),\n xmldom,\n errors;\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("try")]),s._v(" {\n xmldom = parser.parseFromString("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"<root>"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"text/xml"')]),s._v(");\n errors = xmldom.getElementsByTagName("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"parsererror"')]),s._v(");\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (errors.length > "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(") {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Parsing error!"')]),s._v(");\n }\n} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("catch")]),s._v(" (ex) {\n alert("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Parsing error!"')]),s._v(");\n}\n")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("XMLSerializer 类型")])]),a("p",[s._v("DOM 序列化 XML")]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" serializer = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" XMLSerializer();\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xml = serializer.serializeToString(xmldom);\nalert(xml);\n")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("跨浏览器处理 XML")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("parseXml")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("xml")]),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xmldom = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(";\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" DOMParser != "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"undefined"')]),s._v(") {\n   xmldom = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" DOMParser().parseFromString(xml, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"text/xml"')]),s._v(");\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" errors = xmldom.getElementsByTagName("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"parsererror"')]),s._v(");\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (errors.length) {\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"XML parsing error:"')]),s._v(" + errors["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("].textContent);\n   }\n } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" ActiveXObject != "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"undefined"')]),s._v(") {\n   "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//IE8及以前版本兼容处理")]),s._v("\n   xmldom = createDocument();\n   xmldom.loadXML(xml);\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (xmldom.parseError != "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(") {\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"XML parsing error: "')]),s._v(" + xmldom.parseError.reason);\n   }\n } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"No XML parser available."')]),s._v(");\n }\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" xmldom;\n}\n")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("XPath 处理 XML")])]),a("p",[s._v("通过 XPath 可以对 XML 文档进行查询节点处理操作")]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("selectNodes")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("context, expression, namespaces")]),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" doc = context.nodeType != "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("9")]),s._v(" ? context.ownerDocument : context;\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" doc.evaluate != "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"undefined"')]),s._v(") {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" nsresolver = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(";\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (namespaces "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("instanceof")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Object")]),s._v(") {\n     nsresolver = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("prefix")]),s._v(") ")]),s._v("{\n       "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" namespaces[prefix];\n     };\n   }\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" result = doc.evaluate(\n     expression,\n     context,\n     nsresolver,\n     XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,\n     "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n   );\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" nodes = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Array")]),s._v("();\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (result !== "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(") {\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", len = result.snapshotLength; i < len; i++) {\n       nodes.push(result.snapshotItem(i));\n     }\n   }\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" nodes;\n } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" context.selectNodes != "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"undefined"')]),s._v(") {\n   "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//创建命名空间字符串")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (namespaces "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("instanceof")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Object")]),s._v(") {\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" ns = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('""')]),s._v(";\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" prefix "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" namespaces) {\n       "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (namespaces.hasOwnProperty(prefix)) {\n         ns += "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"xmlns:"')]),s._v(" + prefix + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"=\'"')]),s._v(" + namespaces[prefix] + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"\' "')]),s._v(";\n       }\n     }\n     doc.setProperty("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"SelectionNamespaces"')]),s._v(", ns);\n   }\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" result = context.selectNodes(expression);\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" nodes = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Array")]),s._v("();\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", len = result.length; i < len; i++) {\n     nodes.push(result[i]);\n   }\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" nodes;\n } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"No XPath engine found."')]),s._v(");\n }\n}\n")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" result = selectNodes(xmldom.documentElement, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"wrox:book/wrox:author"')]),s._v(", {\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("wrox")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"http://www.wrox.com/"')]),s._v("\n});\nCrossBrowserXPathExample02.htm;\nalert(result.length);\n")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("E4X 的类型")])]),a("ol",[a("li",[s._v("定义全局对象来处理 XML")])]),a("div",{staticClass:"k-snippet--table"},[a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("全局对象")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("描述")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("XML")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("XML 结构中的任何一个独立的部分。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("XMLList")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("XML 对象的集合。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Namespace")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("命名空间前缀与命名空间 URI 之间的映射。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("QName")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("由内部名称和命名空间 URI 组成的一个限定名。")])])])])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("XML 类型")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" x = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" XML(\n "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'<employee position=\"Software Engineer\"><name>Nicholas Zakas</name></employee>'")]),s._v("\n);\n")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("XMLList 类型")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" list = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" XMLList("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"<item/><item/>"')]),s._v(");\n")])]),a("blockquote",[a("p",[s._v("通过 XML 和 XMLList 两种基本类型来处理所有的 XML，通过方法和对应的属性操作")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("JSON 基本语法")])]),a("ol",[a("li",[s._v("简单值:使用与 JavaScript 相同的语法，可以在 JSON 中表示字符串、数值、布尔值和 null。但 JSON 不支持 JavaScript 中的特殊值 undefined。")]),a("li",[s._v("对象:对象作为一种复杂数据类型，表示的是一组无序的键值对儿。而每个键值对儿中的值可以是简单值，也可以是复杂数据类型的值。")]),a("li",[s._v("数组:数组也是一种复杂数据类型，表示一组有序的值的列表，可以通过数值索引来访问其中的值。数组的值也可以是任意类型——简单值、对象或数组。")])]),a("blockquote",[a("p",[s._v("JSON 不支持变量、函数或对象实例，它就是一种表示结构化数据的格式，虽然与 JavaScript 中表示数据的某些语法相同，但它并不局限于 JavaScript 的范畴。")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("JSON 对象")])]),a("ol",[a("li",[s._v("JSON 对象定义")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" book = {\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("title")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Professional JavaScript"')]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("authors")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Nicholas C. Zakas"')]),s._v("],\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("edition")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("year")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2011")]),s._v("\n};\n")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("JSON 序列化")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" jsonText = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".stringify(book);\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('//{"title":"Professional JavaScript","authors":["Nicholas C. Zakas"],"edition":3, "year":2011}')]),s._v("\n")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("序列化过滤")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" book = {\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("title")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Professional JavaScript"')]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("authors")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Nicholas C. Zakas"')]),s._v("],\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("edition")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("year")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2011")]),s._v("\n};\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" jsonText = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".stringify(book, ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"title"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"edition"')]),s._v("]);\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('//{"title":"Professional JavaScript","edition":3}')]),s._v("\n")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" book = {\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("title")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Professional JavaScript"')]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("authors")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Nicholas C. Zakas"')]),s._v("],\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("edition")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("year")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2011")]),s._v("\n};\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" jsonText = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".stringify(book, "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("key, value")]),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("switch")]),s._v(" (key) {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"authors"')]),s._v(":\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" value.join("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('","')]),s._v(");\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"year"')]),s._v(":\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("5000")]),s._v(";\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"edition"')]),s._v(":\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("undefined")]),s._v(";\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(":\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" value;\n }\n});\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('//{"title":"Professional JavaScript","authors":"Nicholas C. Zakas","year":5000}')]),s._v("\n")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("toJSON()方法，自定义处理")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" book = {\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("title")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Professional JavaScript"')]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("authors")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Nicholas C. Zakas"')]),s._v("],\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("edition")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("year")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2011")]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("toJSON")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".title;\n }\n};\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" jsonText = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".stringify(book);\n")])]),a("ol",{attrs:{start:"5"}},[a("li",[s._v("JSON.parse() 解析 JSON 字符串")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" book = {\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("title")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Professional JavaScript"')]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("authors")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Nicholas C. Zakas"')]),s._v("],\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("edition")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("year")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2011")]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("releaseDate")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Date")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2011")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("11")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n};\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" jsonText = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".stringify(book);\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" bookCopy = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".parse(jsonText, "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("key, value")]),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (key == "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"releaseDate"')]),s._v(") {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Date")]),s._v("(value);\n } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" value;\n }\n});\nalert(bookCopy.releaseDate.getFullYear());\n")])]),a("blockquote",[a("p",[s._v("IE8 以前不支持 JSON 对象方法可以使用 "),a("a",{attrs:{href:"https://github.com/douglascrockford/JSON-js/blob/master/json2.js"}},[s._v("json2.js")])])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("XMLHttpRequest 对象")])]),a("ol",[a("li",[s._v("IE8 以前 XHR 是 MSXML 库中的一个 ActiveX 对象实现的，其他浏览器可以直接使用 XMLHttpRequest")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("createXHR")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" XMLHttpRequest != "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"undefined"')]),s._v(") {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" XMLHttpRequest();\n } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" ActiveXObject != "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"undefined"')]),s._v(") {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("arguments")]),s._v(".callee.activeXString != "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"string"')]),s._v(") {\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" versions = [\n         "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"MSXML2.XMLHttp.6.0"')]),s._v(",\n         "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"MSXML2.XMLHttp.3.0"')]),s._v(",\n         "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"MSXML2.XMLHttp"')]),s._v("\n       ],\n       i,\n       len;\n\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" (i = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", len = versions.length; i < len; i++) {\n       "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("try")]),s._v(" {\n         "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" ActiveXObject(versions[i]);\n         "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("arguments")]),s._v(".callee.activeXString = versions[i];\n         "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v(";\n       } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("catch")]),s._v(" (ex) {\n         "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//跳过")]),s._v("\n       }\n     }\n   }\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" ActiveXObject("),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("arguments")]),s._v(".callee.activeXString);\n } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"No XHR object available."')]),s._v(");\n }\n}\n")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("XHR 消息状态属性")])]),a("div",{staticClass:"k-snippet--table"},[a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("属性")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("描述")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("responseText")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("作为响应主体被返回的文本。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("responseXML")]),a("td",{staticStyle:{"text-align":"left"}},[s._v('如果响应的内容类型是"text/xml"或"application/xml"，这个属性中将保存包含着响应数据的 XML DOM 文档。')])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("status")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("响应的 HTTP 状态。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("statusText")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("HTTP 状态的说明。")])])])])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("同步消息处理")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("xhr.open("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"get"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"example.txt"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(");\nxhr.send("),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ((xhr.status >= "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(" && xhr.status < "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("300")]),s._v(") || xhr.status == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("304")]),s._v(") {\n alert(xhr.responseText);\n} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n alert("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Request was unsuccessful: "')]),s._v(" + xhr.status);\n}\n")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("异步请求状态 readyState")])]),a("div",{staticClass:"k-snippet--table"},[a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("值")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("描述")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("0")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("未初始化。尚未调用 open()方法。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("1")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("启动。已经调用 open()方法，但尚未调用 send()方法。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("2")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("发送。已经调用 send()方法，但尚未接收到响应。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("3")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("接收。已经接收到部分响应数据。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("4")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("完成。已经接收到全部响应数据，而且已经可以在客户端使用了。")])])])])]),a("ol",{attrs:{start:"5"}},[a("li",[s._v("readyState 值改变触发 readystatechange 事件")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xhr = createXHR();\nxhr.onreadystatechange = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (xhr.readyState == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(") {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ((xhr.status >= "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(" && xhr.status < "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("300")]),s._v(") || xhr.status == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("304")]),s._v(") {\n     alert(xhr.responseText);\n   } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n     alert("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Request was unsuccessful: "')]),s._v(" + xhr.status);\n   }\n }\n};\nxhr.open("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"get"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"example.txt"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(");\nxhr.send("),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(");\n")])]),a("ol",{attrs:{start:"6"}},[a("li",[s._v("abort()方法取消请求")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("xhr.abort();\n")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("HTTP 头部信息")])]),a("ol",[a("li",[s._v("属性")])]),a("div",{staticClass:"k-snippet--table"},[a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("属性")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("描述")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Accept")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("浏览器能够处理的内容类型。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Accept-Charset")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("浏览器能够显示的字符集。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Accept-Encoding")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("浏览器能够处理的压缩编码。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Accept-Language")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("浏览器当前设置的语言。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Connection")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("浏览器与服务器之间连接的类型。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Cookie")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("当前页面设置的任何 Cookie。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Host")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("发出请求的页面所在的域 。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Referer")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("发出请求的页面的 URI。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("User-Agent")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("浏览器的用户代理字符串。")])])])])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("setRequestHeader() 设置请求头")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xhr = createXHR();\nxhr.onreadystatechange = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (xhr.readyState == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(") {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ((xhr.status >= "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(" && xhr.status < "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("300")]),s._v(") || xhr.status == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("304")]),s._v(") {\n     alert(xhr.responseText);\n   } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n     alert("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Request was unsuccessful: "')]),s._v(" + xhr.status);\n   }\n }\n};\nxhr.open("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"get"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"example.php"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(");\nxhr.setRequestHeader("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"MyHeader"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"MyValue"')]),s._v(");\nxhr.send("),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(");\n")])]),a("blockquote",[a("p",[s._v("要成功发送请求头部信息，必须在调用 open()方法之后且调用 send()方法 之前调用 setRequestHeader(),设置请求头信息有的浏览器不允许覆盖原有参数")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("getResponseHeader()和 getAllResponseHeaders()方法获取请求头参数")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myHeader = xhr.getResponseHeader("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"MyHeader"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" allHeaders = xhr.getAllResponseHeaders();\n")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("GET 请求")])]),a("p",[s._v("GET 请求主要用于查出服务器信息，传递参数需要经过 url 编码防止错误")]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("xhr.open("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"get"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"example.php?name1=value1&name2=value2"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(");\n")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("addURLParam")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("url, name, value")]),s._v(") ")]),s._v("{\n url += url.indexOf("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"?"')]),s._v(") == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("-1")]),s._v(" ? "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"?"')]),s._v(" : "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"&"')]),s._v(";\n url += "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("encodeURIComponent")]),s._v("(name) + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"="')]),s._v(" + "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("encodeURIComponent")]),s._v("(value);\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" url;\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" url = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"example.php"')]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//添加参数")]),s._v("\nurl = addURLParam(url, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"name"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Nicholas"')]),s._v(");\nurl = addURLParam(url, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"book"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Professional JavaScript"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//初始化请求")]),s._v("\nxhr.open("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"get"')]),s._v(", url, "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(");\n")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("POST 请求")])]),a("p",[s._v("POST 向服务传递需要被保存的数据")]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xhr = createXHR();\nxhr.onreadystatechange = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{};\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (xhr.readyState == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(") {\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ((xhr.status >= "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(" && xhr.status < "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("300")]),s._v(") || xhr.status == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("304")]),s._v(") {\n   alert(xhr.responseText);\n } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n   alert("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Request was unsuccessful: "')]),s._v(" + xhr.status);\n }\n}\nxhr.open("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"post"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"postexample.php"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(");\nxhr.setRequestHeader("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Content-Type"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"application/x-www-form-urlencoded"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" form = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"user-info"')]),s._v(");\nxhr.send(serialize(form));\n")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("XMLHttpRequest 2 级")])]),a("ol",[a("li",[s._v("FormData")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xhr = createXHR();\nxhr.onreadystatechange = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (xhr.readyState == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(") {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ((xhr.status >= "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(" && xhr.status < "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("300")]),s._v(") || xhr.status == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("304")]),s._v(") {\n     alert(xhr.responseText);\n   } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n     alert("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Request was unsuccessful: "')]),s._v(" + xhr.status);\n   }\n }\n};\nxhr.open("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"post"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"postexample.php"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" form = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"user-info"')]),s._v(");\nxhr.send("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" FormData(form));\n")])]),a("blockquote",[a("p",[s._v("支持 FormData 的浏览器有 Firefox 4+、Safari 5+、Chrome 和 Android 3+版 WebKit。")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("超时设定")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xhr = createXHR();\nxhr.onreadystatechange = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (xhr.readyState == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(") {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("try")]),s._v(" {\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ((xhr.status >= "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(" && xhr.status < "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("300")]),s._v(") || xhr.status == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("304")]),s._v(") {\n       alert(xhr.responseText);\n     } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n       alert("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Request was unsuccessful: "')]),s._v(" + xhr.status);\n     }\n   } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("catch")]),s._v(" (ex) {\n     "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//假设由 ontimeout 事件处理程序处理")]),s._v("\n   }\n }\n};\n\nxhr.open("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"get"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"timeout.php"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(");\nxhr.timeout = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1000")]),s._v("; "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//将超时设置为1秒钟(仅适用于IE8+)")]),s._v("\nxhr.ontimeout = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n alert("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Request did not return in a second."')]),s._v(");\n};\nxhr.send("),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(");\n")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("overrideMimeType()方法设强制指定返回内容的处理类型文件或者 XML 等")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xhr = createXHR();\nxhr.open("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"get"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"text.php"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(");\nxhr.overrideMimeType("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"text/xml"')]),s._v(");\nxhr.send("),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(");\n")])]),a("blockquote",[a("p",[s._v("支持 overrideMimeType()方法的浏览器有 Firefox、Safari 4+、Opera 10.5 和 Chrome。")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("XHR 进度事件")])]),a("div",{staticClass:"k-snippet--table"},[a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("事件")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("描述")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("loadstart")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("在接收到响应数据的第一个字节时触发。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("progress")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("在接收响应期间持续不断地触发。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("error")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("在请求发生错误时触发。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("abort")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("在因为调用 abort()方法而终止连接时触发。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("load")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("在接收到完整的响应数据时触发。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("loadend")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("在通信完成或者触发 error、abort 或 load 事件后触发。")])])])])]),a("blockquote",[a("p",[s._v("可以用 load 代替 readystatechange 事件，只有部分浏览器支持进度事件")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("CORS")])]),a("p",[s._v("CORS(Cross-Origin Resource Sharing，跨源资源共享)，使用自定义的 HTTP 头部 让浏览器与服务器进行沟通，从而决定请求或响应是应该成功，还是应该失败。\n一个简单的使用 GET 或 POST 发送的请求，它没有自定义的头部，而主体内容是 text/plain。\n在 发送该请求时，需要给它附加一个额外的 Origin 头部，其中包含请求页面的源信息(协议、域名和端 口)，以便服务器根据这个头部信息来决定是否给予响应。\nOrigin 头部示例:"),a("code",{pre:!0},[s._v("Origin: http://www.nczonline.net")]),s._v("\n如果服务器认为这个请求可以接受，就在 "),a("code",{pre:!0},[s._v("Access-Control-Allow-Origin")]),s._v(' 头部中回发相同的源信息(如果是公共资源，可以回发"'),a("code",{pre:!0},[s._v("*")]),s._v('")。\n例如:'),a("code",{pre:!0},[s._v("Access-Control-Allow-Origin")]),s._v(": "),a("code",{pre:!0},[s._v("http://www.nczonline.net")]),s._v("\n如果没有这个头部，或者有这个头部但源信息不匹配，浏览器就会驳回请求。\n正常情况下，浏览器 会处理请求。注意，请求和响应都不包含 "),a("code",{pre:!0},[s._v("cookie")]),s._v(" 信息。")])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("IE 对 CORS 的实现")])]),a("p",[s._v("IE8 中引入了 XDR(XDomainRequest)类型。这个对象与 XHR 类似，但能实现安全可靠 的跨域通信。XDR 对象的安全机制部分实现了 W3C 的 CORS 规范")]),a("ul",[a("li",[s._v("cookie 不会随请求发送，也不会随响应返回。")]),a("li",[s._v("只能设置请求头部信息中的 Content-Type 字段。")]),a("li",[s._v("不能访问响应头部信息。")]),a("li",[s._v("只支持 GET 和 POST 请求。")])]),a("blockquote",[a("p",[s._v("这些变化使 CSRF(Cross-Site Request Forgery，跨站点请求伪造)和 XSS(Cross-Site Scripting，跨 站点脚本)的问题得到了缓解")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xdr = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" XDomainRequest();\nxdr.onload = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n alert(xdr.responseText);\n};\nxdr.onerror = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n alert("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"An error occurred."')]),s._v(");\n};\nxdr.open("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"post"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"http://www.somewhere-else.com/page/"')]),s._v(");\nxdr.contentType = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"application/x-www-form-urlencoded"')]),s._v(";\nxdr.send("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"name1=value1&name2=value2"')]),s._v(");\n")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("其他浏览器对 CORS 的实现")])]),a("p",[s._v("Firefox 3.5+、Safari 4+、Chrome、iOS 版 Safari 和 Android 平台中的 WebKit 都通过 XMLHttpRequest 对象实现了对 CORS 的原生支持")]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xhr = createXHR();\nxhr.onreadystatechange = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (xhr.readyState == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(") {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ((xhr.status >= "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(" && xhr.status < "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("300")]),s._v(") || xhr.status == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("304")]),s._v(") {\n     alert(xhr.responseText);\n   } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n     alert("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Request was unsuccessful: "')]),s._v(" + xhr.status);\n   }\n }\n};\nxhr.open("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"get"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"http://www.somewhere-else.com/page/"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(");\nxhr.send("),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(");\n")])]),a("ul",[a("li",[s._v("不能使用 "),a("code",{pre:!0},[s._v("setRequestHeader()")]),s._v(" 设置自定义头部。")]),a("li",[s._v("不能发送和接收 "),a("code",{pre:!0},[s._v("cookie")]),s._v("。")]),a("li",[s._v("调用 "),a("code",{pre:!0},[s._v("getAllResponseHeaders()")]),s._v(" 方法总会返回空字符串。")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("Preflighted Reqeusts")])]),a("p",[s._v("CORS 通过一种叫做 Preflighted Requests 的透明服务器验证机制支持开发人员使用自定义的头部、 GET 或 POST 之外的方法，以及不同类型的主体内容。\n在使用下列高级选项来发送请求时，就会向服务 器发送一个 Preflight 请求。这种请求使用 OPTIONS 方法，发送下列头部。")]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("Origin: http:"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//www.nczonline.net")]),s._v("\nAccess-Control-Request-Method: POST\nAccess-Control-Request-Headers: NCZ\n")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("Access-Control-Allow-Origin: http:"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//www.nczonline.net")]),s._v("\nAccess-Control-Allow-Methods: POST, GET\nAccess-Control-Allow-Headers: NCZ\nAccess-Control-Max-Age: "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1728000")]),s._v("\n")])]),a("blockquote",[a("p",[s._v("Preflight 请求结束后，结果将按照响应中指定的时间缓存起来。而为此付出的代价只是第一次发送 这种请求时会多一次 HTTP 请求。\n支持 Preflight 请求的浏览器包括 Firefox 3.5+、Safari 4+和 Chrome。IE 10 及更早版本都不支持。")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("带凭据的请求")])]),a("p",[s._v("默认情况下，跨源请求不提供凭据(cookie、HTTP 认证及客户端 SSL 证明等)。通过将 withCredentials 属性设置为 true，可以指定某个请求应该发送凭据。\n如果服务器接受带凭据的请 求，会用下面的 HTTP 头部来响应。")]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("Access-Control-Allow-Credentials: "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n")])]),a("blockquote",[a("p",[s._v("支持 withCredentials 属性的浏览器有 Firefox 3.5+、Safari 4+和 Chrome。IE 10 及更早版本都不 9 支持")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("跨浏览器的 CORS")])]),a("div",{staticClass:"k-snippet--table"},[a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("方法")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("描述")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("abort()")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("用于停止正在进行的请求。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("onerror")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("用于替代 onreadystatechange 检测错误。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("onload")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("用于替代 onreadystatechange 检测成功。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("responseText")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("用于取得响应内容。")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("send()")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("用于发送请求。")])])])])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("createCORSRequest")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("method, url")]),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xhr = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" XMLHttpRequest();\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"withCredentials"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" xhr) {\n   xhr.open(method, url, "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(");\n } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" XDomainRequest != "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"undefined"')]),s._v(") {\n   vxhr = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" XDomainRequest();\n   xhr.open(method, url);\n } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n   xhr = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(";\n }\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" xhr;\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" request = createCORSRequest("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"get"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"http://www.somewhere-else.com/page/"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (request) {\n request.onload = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n   "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//对 request.responseText 进行处理")]),s._v("\n };\n request.send();\n}\n")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("其他跨域技术")])]),a("ol",[a("li",[s._v("图片访问不受限制，只能发送 GET 请求")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" img = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Image();\nimg.onload = img.onerror = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n alert("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Done!"')]),s._v(");\n};\nimg.src = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"http://www.example.com/test?name=Nicholas"')]),s._v(";\n")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("JSONP 本地定义一个方法加载 script 包含数据和调用本地的方法")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("handleResponse")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("response")]),s._v(") ")]),s._v("{\n alert(\n   "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"You’re at IP address "')]),s._v(" +\n     response.ip +\n     "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('", which is in "')]),s._v(" +\n     response.city +\n     "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('", "')]),s._v(" +\n     response.region_name\n );\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" script = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".createElement("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"script"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//script脚本内容handleResponse(返回数据)")]),s._v("\nscript.src = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"http://freegeoip.net/json/?callback=handleResponse"')]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".body.insertBefore(script, "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".body.firstChild);\n")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("Comet")])]),a("ol",[a("li",[s._v("Comet：服务器像浏览器推送信息服务")]),a("li",[s._v("短轮询，定时发送请求检测服务器返回数据是否更新")]),a("li",[s._v("长轮询，发送请求一直等待服务器返回响应数据，响应后继续发请求等待")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("服务器通信")])]),a("ol",[a("li",[s._v("SSE：创建单向连接服务器可以返回信息触发事件")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" source = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" EventSource("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"myevents.php"')]),s._v(");\nsource.onmessage = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("event")]),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" data = event.data; "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//处理数据")]),s._v("\n};\nsource.onerror = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("event")]),s._v(") ")]),s._v("{\n alert("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"error"')]),s._v(");\n};\n")])]),a("blockquote",[a("p",[s._v("支持 Firefox 6+、Safari 5+、Opera 11+、Chrome 和 iOS 4+版 Safari")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("Web Sockets 和浏览器建立全双工通信")])]),a("div",{staticClass:"k-snippet--tag k-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" socket = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" WebSocket("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ws://www.example.com/server.php"')]),s._v(");\nsocket.send("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Hello world!"')]),s._v(");\nsocket.onmessage = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("event")]),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" data = event.data;\n "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//处理数据")]),s._v("\n};\n")])])],2),a("k-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("同源策略")])]),a("p",[s._v("同源策略是对 XHR 的一个主要约束，它为通信设置了“相同的域、相同的端口、相同的协议”这一限制。\n试图访问上述限制之外的资源，都会引发安全错误，除非采用被认可的跨域解决方案。\n这个解决 方案叫做 CORS(Cross-Origin Resource Sharing，跨源资源共享)，IE8 通过 XDomainRequest 对象支持 CORS，其他浏览器通过 XHR 对象原生支持 CORS。\n图像 Ping 和 JSONP 是另外两种跨域通信的技术， 但不如 CORS 稳妥。")])],2)],1)},e=[],l=a("25c1"),n={},p=Object(l["a"])(n,r,e,!1,null,null,null);p.options.__file="21.md";t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2d230350.12868847.js.map